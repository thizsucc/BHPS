<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="styles.css">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Payment</title>
  <style>
body { font-family: "Segoe UI", Arial, sans-serif; margin:0; background:#f9f9f9; }
header { background:#003366; color:white; padding:12px 24px; display:flex; align-items:center; justify-content:space-between; flex-wrap:wrap; }
header .logo { font-size:20px; font-weight:bold; }
nav a { color:white; margin:0 12px; text-decoration:none; font-size:14px; }
nav a:hover { text-decoration:underline; }
main { display:grid; grid-template-columns:2fr 3fr; gap:32px; padding:24px; max-width:1100px; margin:auto; }
h2 { color:#003366; margin-bottom:12px; }
.card { background:white; padding:20px; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
.product-line { display:flex; justify-content:space-between; margin:8px 0; transition:0.2s; }
.product-line:hover { background:#f1f6fc; border-radius:6px; padding:6px; }
.product-line + .product-line { border-top:1px solid #eee; padding-top:8px; }
.small { font-size:0.9em; color:#666; }
.summary div { margin:6px 0; }
label { display:block; margin-top:12px; font-weight:600; color:#003366; }
input { width:100%; padding:8px; margin-top:4px; border:1px solid #ccc; border-radius:4px; }
button { margin-top:20px; padding:12px; width:100%; background:#003366; color:#fff; border:none; border-radius:6px; font-size:16px; cursor:pointer; transition:0.3s; }
button:hover { background:#0055a5; }
footer {
  text-align:center; 
  padding:12px; 
  font-size:14px; 
  margin-top:30px; 
  position: fixed; 
  bottom: 0;
  left: 0; 
  width: 100%; 
  background-color: #333;
  color: white;
  padding: 15px;
  text-align: center;
  z-index: 1000;
}
form { margin-top:20px; display:flex; flex-direction:column; gap:12px; }
input[type="text"], input[type="email"], input[type="password"] {
  font-size: 14px;
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 4px;
  width: 100%;
  box-sizing: border-box;
}
.error-msg { font-size:12px; color:red; margin-top:4px; }
.card-icons img { height:24px; margin-right:6px; }
.row { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
.loading { margin-top:15px; font-weight:bold; color:#0055a5; }
.hidden { display:none; }

/* Responsive */
@media (max-width: 768px) {
  main { grid-template-columns:1fr; padding:16px; }
  nav a { margin:0 8px; font-size:13px; }
}
@media (max-width: 480px) {
  header { flex-direction:column; align-items:flex-start; }
  header .logo { margin-bottom:8px; }
  nav a { margin:4px 0; }
}
  </style>
</head>
<body>
<header>
  <div class="logo">BookHeaven</div>
  <nav>
    <a href="#">Home</a>
    <a href="#">Books</a>
    <a href="#">Cart</a>
    <a href="#">Checkout</a>
  </nav>
</header>

<main>
  <!-- Left column: Order summary -->
  <div class="card">
    <h2>Your Order</h2>
    <div id="orderSummary"></div>
    <div class="summary">
      <div>Subtotal: <span id="subtotal"></span></div>
      <div>Shipping: <span id="shipping"></span></div>
      <strong>Total: <span id="total"></span></strong>
    </div>
  </div>

  <!-- Right column: Checkout form -->
  <div class="card">
    <h2>Payment Details</h2>
    <form id="checkoutForm" novalidate>
      <div>
        <label for="email">Email</label>
        <input type="email" id="email" required>
        <div class="error-msg" id="emailError"></div>
      </div>

      <div>
        <label for="cardNumber">Card Number</label>
        <input type="text" id="cardNumber" placeholder="1234 5678 9012 3456" autocomplete="off" required>
        <div class="card-icons">
          <img src="https://img.icons8.com/color/48/visa.png" alt="Visa">
          <img src="https://img.icons8.com/color/48/mastercard.png" alt="MasterCard">
          <img src="https://img.icons8.com/color/48/jcb.png" alt="JCB">
        </div>
        <div class="error-msg" id="cardError"></div>
      </div>

      <div class="row">
        <div>
          <label for="expiry">Expiry (MM/YY)</label>
          <input type="text" id="expiry" placeholder="MM/YY" required>
          <div class="error-msg" id="expiryError"></div>
        </div>
        <div>
          <label for="cvv">CVV</label>
          <input type="password" id="cvv" maxlength="4" required>
          <div class="error-msg" id="cvvError"></div>
        </div>
      </div>

      <button type="submit">Pay RM <span id="totalAmount"></span></button>
    </form>
    <div id="loading" class="loading hidden">Processing payment...</div>
  </div>
</main>

<footer>
  Prices, stock and payment options. Accept VISA, MasterCard and JCB.
</footer>

<script>
// Demo cart
const cart = [
  {title:'Danger Days: The True Lives of the Fabulous Killjoys', price:54.90, qty:1},
  {title:'Who Killed Kurt Cobain?', price:79.90, qty:1}
];

function formatRM(v){return v.toLocaleString('en-MY',{minimumFractionDigits:2,maximumFractionDigits:2})}

function renderSummary(){
  const container=document.getElementById('orderSummary');container.innerHTML='';
  let subtotal=0;
  cart.forEach(item=>{
    subtotal+=item.price*item.qty;
    const line=document.createElement('div');
    line.className='product-line';
    line.innerHTML=`<div><div style="font-weight:600">${item.title}</div><div class="small">Qty ${item.qty}</div></div><div>RM ${formatRM(item.price*item.qty)}</div>`;
    container.appendChild(line);
  });
  const shipping=6.00;
  document.getElementById('subtotal').textContent='RM '+formatRM(subtotal);
  document.getElementById('shipping').textContent='RM '+formatRM(shipping);
  document.getElementById('total').textContent='RM '+formatRM(subtotal+shipping);
  document.getElementById('totalAmount').textContent=formatRM(subtotal+shipping);
}

// card input helpers
document.getElementById('cardNumber').addEventListener('input',e=>{
  let v=e.target.value.replace(/\D/g,'').slice(0,16);
  v=v.replace(/(\d{4})/g,'$1 ').trim();
  e.target.value=v;
});
document.getElementById('expiry').addEventListener('input',e=>{
  let v=e.target.value.replace(/\D/g,'').slice(0,4);
  if(v.length>2) v=v.slice(0,2)+'/'+v.slice(2);
  e.target.value=v;
});

// Luhn check
function luhnCheck(num){
  const s=num.replace(/\s+/g,'');if(!/^[0-9]{13,19}$/.test(s))return false;
  let sum=0,flip=false;
  for(let i=s.length-1;i>=0;i--){let d=+s[i];if(flip){d*=2;if(d>9)d-=9;}sum+=d;flip=!flip}
  return sum%10===0
}

// Inline validation
function showError(id,msg){
  document.getElementById(id).textContent=msg;
}
function clearErrors(){
  ['emailError','cardError','expiryError','cvvError'].forEach(id=>{
    document.getElementById(id).textContent='';
  });
}

document.getElementById('checkoutForm').addEventListener('submit',e=>{
  e.preventDefault();
  clearErrors();

  const cardNum=document.getElementById('cardNumber').value;
  const email=document.getElementById('email').value;
  const expiry=document.getElementById('expiry').value;
  const cvv=document.getElementById('cvv').value;

  let valid=true;
  if(!/.+@.+\..+/.test(email)){showError('emailError','Enter a valid email');valid=false}
  if(!luhnCheck(cardNum)){showError('cardError','Invalid card number');valid=false}
  if(!/^(0[1-9]|1[0-2])\/\d{2}$/.test(expiry)){showError('expiryError','Use MM/YY format');valid=false}
  if(!/^\d{3,4}$/.test(cvv)){showError('cvvError','Enter 3â€“4 digits');valid=false}

  if(!valid) return;

  // Simulate loading
  document.getElementById('loading').classList.remove('hidden');
  setTimeout(()=>{
    document.getElementById('loading').classList.add('hidden');
    alert('Payment processed (demo). Thank you!');
  },2000);
});

renderSummary();
document.getElementById("email").focus();
</script>

</body>
</html>
