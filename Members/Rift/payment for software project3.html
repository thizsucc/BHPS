<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Payment</title>
  <style>
    body { font-family: "Segoe UI", Arial, sans-serif; margin:0; background:#f9f9f9; }
    header { background:#003366; color:white; padding:12px 24px; display:flex; align-items:center; justify-content:space-between; }
    header .logo { font-size:20px; font-weight:bold; }
    nav a { color:white; margin:0 12px; text-decoration:none; font-size:14px; }
    nav a:hover { text-decoration:underline; }
    main { display:grid; grid-template-columns:2fr 3fr; gap:32px; padding:24px; max-width:1100px; margin:auto; }
    h2 { color:#003366; margin-bottom:12px; }
    .card { background:white; padding:20px; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
    .product-line { display:flex; justify-content:space-between; margin:8px 0; }
    .small { font-size:0.9em; color:#666; }
    .summary div { margin:6px 0; }
    label { display:block; margin-top:12px; font-weight:600; color:#003366; }
    input { width:100%; padding:8px; margin-top:4px; border:1px solid #ccc; border-radius:4px; }
    button { margin-top:20px; padding:12px; width:100%; background:#003366; color:#fff; border:none; border-radius:6px; font-size:16px; cursor:pointer; }
    button:hover { background:#0055a5; }
    footer { background:#f0f0f0; text-align:center; padding:12px; font-size:14px; color:#333; margin-top:30px; }
  </style>
</head>
<body>

<header>
  <div class="logo">BookHeaven</div>
  <nav>
    <a href="#">Home</a>
    <a href="#">Books</a>
    <a href="#">Cart</a>
    <a href="#">Checkout</a>
  </nav>
</header>

<main>
  <!-- Left column: Order summary -->
  <div class="card">
    <h2>Your Order</h2>
    <div id="orderSummary"></div>
    <div class="summary">
      <div>Subtotal: <span id="subtotal"></span></div>
      <div>Shipping: <span id="shipping"></span></div>
      <strong>Total: <span id="total"></span></strong>
    </div>
  </div>

  <!-- Right column: Checkout form -->
  <div class="card">
    <h2>Payment Details</h2>
    <form id="checkoutForm">
      <label>Email</label>
      <input type="email" id="email" required>

      <label>Card Number</label>
      <input type="text" id="cardNumber" placeholder="1234 5678 9012 3456" required>

      <label>Expiry (MM/YY)</label>
      <input type="text" id="expiry" placeholder="MM/YY" required>

      <label>CVV</label>
      <input type="text" id="cvv" maxlength="4" required>

      <button type="submit">Pay RM <span id="totalAmount"></span></button>
    </form>
  </div>
</main>

<footer>
  Prices, stock and payment options. Accept VISA, MasterCard and JCB.
</footer>

<script>
// Demo cart
const cart = [
  {title:'Danger Days: The True Lives of the Fabulous Killjoys', price:54.90, qty:1},
  {title:'Who Killed Kurt Cobain?', price:79.90, qty:1}
];

function formatRM(v){return v.toLocaleString('en-MY',{minimumFractionDigits:2,maximumFractionDigits:2})}

function renderSummary(){
  const container=document.getElementById('orderSummary');container.innerHTML='';
  let subtotal=0;
  cart.forEach(item=>{
    subtotal+=item.price*item.qty;
    const line=document.createElement('div');
    line.className='product-line';
    line.innerHTML=`<div><div style="font-weight:600">${item.title}</div><div class="small">Qty ${item.qty}</div></div><div>RM ${formatRM(item.price*item.qty)}</div>`;
    container.appendChild(line);
  });
  const shipping=6.00;
  document.getElementById('subtotal').textContent='RM '+formatRM(subtotal);
  document.getElementById('shipping').textContent='RM '+formatRM(shipping);
  document.getElementById('total').textContent='RM '+formatRM(subtotal+shipping);
  document.getElementById('totalAmount').textContent=formatRM(subtotal+shipping);
}

// card input helpers
document.getElementById('cardNumber').addEventListener('input',e=>{
  let v=e.target.value.replace(/\D/g,'').slice(0,16);
  v=v.replace(/(\d{4})/g,'$1 ').trim();
  e.target.value=v;
});
document.getElementById('expiry').addEventListener('input',e=>{
  let v=e.target.value.replace(/\D/g,'').slice(0,4);
  if(v.length>2) v=v.slice(0,2)+'/'+v.slice(2);
  e.target.value=v;
});

// Luhn check
function luhnCheck(num){
  const s=num.replace(/\s+/g,'');if(!/^[0-9]{13,19}$/.test(s))return false;
  let sum=0,flip=false;
  for(let i=s.length-1;i>=0;i--){let d=+s[i];if(flip){d*=2;if(d>9)d-=9;}sum+=d;flip=!flip}
  return sum%10===0
}

document.getElementById('checkoutForm').addEventListener('submit',e=>{
  e.preventDefault();
  const cardNum=document.getElementById('cardNumber').value;
  const email=document.getElementById('email').value;
  if(!luhnCheck(cardNum)){alert('Please enter a valid card number.');return}
  if(!email||!/.+@.+\..+/.test(email)){alert('Please enter a valid email.');return}
  alert('Payment processed (demo). Thank you!')
});

renderSummary();
</script>

</body>
</html>
