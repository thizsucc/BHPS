<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="styles.css">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Book Ordering</title>
  <style>
    body { font-family:"Segoe UI",Arial,sans-serif; margin:0; background:#f9f9f9; }
    header { background:#003366; color:white; padding:12px 24px; display:flex; align-items:center; justify-content:space-between; flex-wrap:wrap; }
    header .logo { font-size:20px; font-weight:bold; }
    nav a { color:white; margin:0 12px; text-decoration:none; font-size:14px; }
    nav a:hover { text-decoration:underline; }
    main { display:grid; grid-template-columns:2fr 3fr; gap:32px; padding:24px; max-width:1100px; margin:auto; }
    h2 { color:#003366; margin-bottom:12px; }
    .card { background:white; padding:20px; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
    .book-item { display:flex; justify-content:space-between; align-items:center; margin:12px 0; }
    .book-info { flex:1; }
    .book-title { font-weight:600; }
    .book-author { font-size:0.9em; color:#666; }
    .book-controls input { width:50px; text-align:center; }
    .summary div { margin:6px 0; }
    label { display:block; margin-top:12px; font-weight:600; color:#003366; }
    input { width:100%; padding:8px; margin-top:4px; border:1px solid #ccc; border-radius:4px; }
    button { margin-top:20px; padding:12px; width:100%; background:#003366; color:#fff; border:none; border-radius:6px; font-size:16px; cursor:pointer; transition:0.3s; }
    button:hover { background:#0055a5; }
    footer { text-align:center; padding:15px; font-size:14px; margin-top:30px; background-color:#333; color:white; }
    .row { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
    .error-msg { font-size:12px; color:red; margin-top:4px; }
    .loading { margin-top:15px; font-weight:bold; color:#0055a5; }
    .hidden { display:none; }
    @media (max-width:768px){ main{grid-template-columns:1fr; padding:16px;} }
  </style>
</head>
<body>
<header>
  <div class="logo">BookHeaven</div>
  <nav>
    <a href="#">Home</a>
    <a href="#">Books</a>
    <a href="#">Cart</a>
    <a href="#">Checkout</a>
  </nav>
</header>

<main>
  <!-- Left column: Book selection -->
  <div class="card">
    <h2>Select Your Books</h2>
    <div id="bookList"></div>
    <h3>Order Summary</h3>
    <div class="summary">
      <div>Subtotal: <span id="subtotal"></span></div>
      <div>Shipping: <span id="shipping"></span></div>
      <strong>Total: <span id="total"></span></strong>
    </div>
  </div>

  <!-- Right column: Checkout form -->
  <div class="card">
    <h2>Checkout</h2>
    <form id="checkoutForm" novalidate>
      <div>
        <label for="email">Email</label>
        <input type="email" id="email" required>
        <div class="error-msg" id="emailError"></div>
      </div>

      <div>
        <label for="cardNumber">Card Number</label>
        <input type="text" id="cardNumber" placeholder="1234 5678 9012 3456" autocomplete="off" required>
        <div class="error-msg" id="cardError"></div>
      </div>

      <div class="row">
        <div>
          <label for="expiry">Expiry (MM/YY)</label>
          <input type="text" id="expiry" placeholder="MM/YY" required>
          <div class="error-msg" id="expiryError"></div>
        </div>
        <div>
          <label for="cvv">CVV</label>
          <input type="password" id="cvv" maxlength="4" required>
          <div class="error-msg" id="cvvError"></div>
        </div>
      </div>

      <button type="submit">Pay RM <span id="totalAmount"></span></button>
    </form>
    <div id="loading" class="loading hidden">Processing payment...</div>
  </div>
</main>

<footer>
  BookHeaven © 2025 | Secure payments with VISA, MasterCard, JCB.
</footer>

<script>
const books = [
  {title:'Danger Days: The True Lives of the Fabulous Killjoys', author:'Gerard Way, Shaun Simon', price:54.90, qty:0},
  {title:'Kafka on the Shore', author:'Haruki Murakami', price:52.00, qty:0},
  {title:'Who Killed Kurt Cobain?', author:'Ian Halperin, Max Wallace', price:79.90, qty:0},
  {title:'Dune', author:'Frank Herbert', price:89.90, qty:0}
];

function formatRM(v){return v.toLocaleString('en-MY',{minimumFractionDigits:2,maximumFractionDigits:2})}

function renderBooks(){
  const container=document.getElementById('bookList');container.innerHTML='';
  books.forEach((book,i)=>{
    const div=document.createElement('div');
    div.className='book-item';
    div.innerHTML=`
      <div class="book-info">
        <div class="book-title">${book.title}</div>
        <div class="book-author">by ${book.author}</div>
        <div>RM ${formatRM(book.price)}</div>
      </div>
      <div class="book-controls">
        <input type="number" min="0" value="${book.qty}" data-index="${i}">
      </div>
    `;
    container.appendChild(div);
  });
}

function updateSummary(){
  let subtotal=0;
  books.forEach(b=>subtotal+=b.price*b.qty);
  const shipping=subtotal>0?6.00:0.00;
  document.getElementById('subtotal').textContent='RM '+formatRM(subtotal);
  document.getElementById('shipping').textContent='RM '+formatRM(shipping);
  document.getElementById('total').textContent='RM '+formatRM(subtotal+shipping);
  document.getElementById('totalAmount').textContent=formatRM(subtotal+shipping);
}

document.addEventListener('input',e=>{
  if(e.target.matches('input[type="number"]')){
    const idx=e.target.dataset.index;
    books[idx].qty=parseInt(e.target.value)||0;
    updateSummary();
  }
});

// Basic card formatting
document.getElementById('cardNumber').addEventListener('input',e=>{
  let v=e.target.value.replace(/\D/g,'').slice(0,16);
  v=v.replace(/(\d{4})/g,'$1 ').trim();
  e.target.value=v;
});
document.getElementById('expiry').addEventListener('input',e=>{
  let v=e.target.value.replace(/\D/g,'').slice(0,4);
  if(v.length>2) v=v.slice(0,2)+'/'+v.slice(2);
  e.target.value=v;
});

// Checkout validation
function showError(id,msg){ document.getElementById(id).textContent=msg; }
function clearErrors(){ ['emailError','cardError','expiryError','cvvError'].forEach(id=>document.getElementById(id).textContent=''); }
document.getElementById('checkoutForm').addEventListener('submit',e=>{
  e.preventDefault(); clearErrors();
  const email=document.getElementById('email').value;
  const card=document.getElementById('cardNumber').value.replace(/\s+/g,'');
  const expiry=document.getElementById('expiry').value;
  const cvv=document.getElementById('cvv').value;
  let valid=true;
  if(!/.+@.+\..+/.test(email)){showError('emailError','Enter a valid email');valid=false}
  if(card.length<13){showError('cardError','Invalid card number');valid=false}
  if(!/^(0[1-9]|1[0-2])\/\d{2}$/.test(expiry)){showError('expiryError','Use MM/YY');valid=false}
  if(!/^\d{3,4}$/.test(cvv)){showError('cvvError','Enter 3–4 digits');valid=false}
  if(!valid) return;

  document.getElementById('loading').classList.remove('hidden');
  setTimeout(()=>{
    document.getElementById('loading').classList.add('hidden');
    alert('Order placed! Thank you for shopping with BookHeaven.');
  },2000);
});

renderBooks();
updateSummary();
</script>
</body>
</html>
